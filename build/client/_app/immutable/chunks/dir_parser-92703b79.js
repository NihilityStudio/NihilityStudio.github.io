import{c as et}from"./_commonjsHelpers-cea7ac1a.js";var ae={exports:{}};(function(g,m){(function(h,y){g.exports=y()})(et,function(){function h(n,r){if(!(n instanceof r))throw new TypeError("Cannot call a class as a function")}function y(n,r){for(var e=0;e<r.length;e++){var i=r[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function p(n,r,e){return r&&y(n.prototype,r),e&&y(n,e),n}function o(n,r,e){return r in n?Object.defineProperty(n,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[r]=e,n}function v(n,r){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);r&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})),e.push.apply(e,i)}return e}function u(n){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?v(Object(e),!0).forEach(function(i){o(n,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):v(Object(e)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(e,i))})}return n}function U(n,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(r&&r.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),r&&V(n,r)}function _(n){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_(n)}function V(n,r){return V=Object.setPrototypeOf||function(i,t){return i.__proto__=t,i},V(n,r)}function X(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Z(n,r,e){return X()?Z=Reflect.construct:Z=function(t,s,a){var l=[null];l.push.apply(l,s);var c=Function.bind.apply(t,l),d=new c;return a&&V(d,a.prototype),d},Z.apply(null,arguments)}function ue(n){return Function.toString.call(n).indexOf("[native code]")!==-1}function H(n){var r=typeof Map=="function"?new Map:void 0;return H=function(i){if(i===null||!ue(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof r<"u"){if(r.has(i))return r.get(i);r.set(i,t)}function t(){return Z(i,arguments,_(this).constructor)}return t.prototype=Object.create(i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),V(t,i)},H(n)}function A(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function de(n,r){return r&&(typeof r=="object"||typeof r=="function")?r:A(n)}function Y(n){var r=X();return function(){var i=_(n),t;if(r){var s=_(this).constructor;t=Reflect.construct(i,arguments,s)}else t=i.apply(this,arguments);return de(this,t)}}function he(n,r){for(;!Object.prototype.hasOwnProperty.call(n,r)&&(n=_(n),n!==null););return n}function E(n,r,e){return typeof Reflect<"u"&&Reflect.get?E=Reflect.get:E=function(t,s,a){var l=he(t,s);if(!!l){var c=Object.getOwnPropertyDescriptor(l,s);return c.get?c.get.call(a):c.value}},E(n,r,e||n)}function j(n,r){return Se(n)||ge(n,r)||B(n,r)||me()}function C(n){return fe(n)||pe(n)||B(n)||ve()}function fe(n){if(Array.isArray(n))return $(n)}function Se(n){if(Array.isArray(n))return n}function pe(n){if(typeof Symbol<"u"&&Symbol.iterator in Object(n))return Array.from(n)}function ge(n,r){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(n)))){var e=[],i=!0,t=!1,s=void 0;try{for(var a=n[Symbol.iterator](),l;!(i=(l=a.next()).done)&&(e.push(l.value),!(r&&e.length===r));i=!0);}catch(c){t=!0,s=c}finally{try{!i&&a.return!=null&&a.return()}finally{if(t)throw s}}return e}}function B(n,r){if(!!n){if(typeof n=="string")return $(n,r);var e=Object.prototype.toString.call(n).slice(8,-1);if(e==="Object"&&n.constructor&&(e=n.constructor.name),e==="Map"||e==="Set")return Array.from(n);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return $(n,r)}}function $(n,r){(r==null||r>n.length)&&(r=n.length);for(var e=0,i=new Array(r);e<r;e++)i[e]=n[e];return i}function ve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function me(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ye(n,r){var e;if(typeof Symbol>"u"||n[Symbol.iterator]==null){if(Array.isArray(n)||(e=B(n))||r&&n&&typeof n.length=="number"){e&&(n=e);var i=0,t=function(){};return{s:t,n:function(){return i>=n.length?{done:!0}:{done:!1,value:n[i++]}},e:function(c){throw c},f:t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,l;return{s:function(){e=n[Symbol.iterator]()},n:function(){var c=e.next();return s=c.done,c},e:function(c){a=!0,l=c},f:function(){try{!s&&e.return!=null&&e.return()}finally{if(a)throw l}}}}var P=function(r,e,i){var t=r.x,s=r.y,a=i.x,l=i.y,c={"+":{x:t+a,y:s+l},"-":{x:t-a,y:s-l},"*":{x:t*a,y:s*l},"/":{x:t/a,y:s/l}};return c[e]},M=function(r){return{x:r.left,y:r.top}},q=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return{left:r.x,top:r.y,right:r.x,bottom:r.y,width:e,height:e}},be=function(r){return{x:r,y:r}},J=function(n,r){var e=r;window.addEventListener("resize",e),window.addEventListener("scroll",e);var i=new MutationObserver(e);n.forEach(function(s,a){i.observe(s,{childList:a!==0,attributes:!0})});var t=function(){return Ne(i,e)};return{observer:i,callback:e,cleanup:t}},De=function(n){var r=z(n);return r.x||r.y?!0:n instanceof Document?n.body?!!(n.body.scrollTop=1):!!(n.documentElement.scrollTop=1):!!(n.scrollTop=1)},_e=function(){var n=document.createElement("div");return n.style.position="fixed",n.style.overflow="hidden",n.style.pointerEvents="none",n.style.zIndex="999999999999999999",n},Pe=function(n){var r=document.createElement("div");return r.style.position="absolute",n||(r.style.background="rgba(0, 175, 255, 0.2)",r.style.border="1px solid rgba(0, 175, 255, 0.8)",r.style.display="none",r.style.pointerEvents="none"),r},Q=function(n,r){var e;return function(){for(var i=arguments.length,t=new Array(i),s=0;s<i;s++)t[s]=arguments[s];var a=function(){e=null,n.apply(void 0,t)};clearTimeout(e),e=setTimeout(a,r)}},W=function(){var n,r,e,i;return{y:((n=document.body)===null||n===void 0?void 0:n.scrollTop)||((r=document.documentElement)===null||r===void 0?void 0:r.scrollTop)||0,x:((e=document.body)===null||e===void 0?void 0:e.scrollLeft)||((i=document.documentElement)===null||i===void 0?void 0:i.scrollLeft)||0}},F=function(n){var r=function e(i){var t,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=(t=i[s])===null||t===void 0?void 0:t.parentNode;return a?(i.push(a),s++,e(i,s)):i};return r([n])},Ie=function(n,r){if(n instanceof Document)return{top:0,left:0,bottom:0,right:0,width:window.innerWidth,height:window.innerHeight};var e=n.getBoundingClientRect();return{top:e.top,left:e.left,bottom:e.bottom,right:e.right,width:(n.clientWidth||e.width)*r,height:(n.clientHeight||e.height)*r}},z=function(n){return!n||n instanceof Document?W():{x:n.scrollLeft>=0?n.scrollLeft:W().x,y:n.scrollTop>=0?n.scrollTop:W().y}},ee=function(n){var r=n.elementRect,e=n.containerRect,i=n.tolerance,t=i===void 0?{x:0,y:0}:i,s=[];return r.top-t.y<e.top&&s.push("top"),r.left-t.x<e.left&&s.push("left"),r.bottom+t.y>e.bottom&&s.push("bottom"),r.right+t.y>e.right&&s.push("right"),s},Ae=function(n){var r=n.event;return{x:r.clientX,y:r.clientY}},Le=function(n){var r=n.scrollAmount,e=n.initialPointerPos,i=n.pointerPos,t={};return i.x>e.x-r.x?(t.left=e.x-r.x,t.width=i.x-e.x+r.x):(t.left=i.x,t.width=e.x-i.x-r.x),i.y>e.y-r.y?(t.top=e.y-r.y,t.height=i.y-e.y+r.y):(t.top=i.y,t.height=e.y-i.y-r.y),t},te=function(r){var e={x:0,y:0},i=window.getComputedStyle(r);if(!i.transform||i.transform==="none")return e;if(i.transform.indexOf("3d")>=0){var t=i.transform.trim().match(/matrix3d\((.*?)\)/);if(t&&t.length){var s,a=(s=t[1])===null||s===void 0?void 0:s.split(",");e.x=parseInt(a[12])||0,e.y=parseInt(a[13])||0}return e}var l=i.transform.trim().match(/matrix\((.*?)\)/);if(l&&l.length){var c,d=(c=l[1])===null||c===void 0?void 0:c.split(",");e.x=parseInt(d[4])||0,e.y=parseInt(d[5])||0}return e},Te=function(r){var e=r.style.transform;if(!e||e.indexOf("translate")<0)return te(r);var i={x:0,y:0},t=e.trim().match(/translate[3dD]*?\(.*?\)/);if(t){var s,a=(s=t[0])===null||s===void 0?void 0:s.split("(");if(a){var l,c=(l=a[1])===null||l===void 0?void 0:l.split(",");i.x=parseInt(c[0])||0,i.y=parseInt(c[1])||0}}return!i.x&&!i.x?te(r):i},Ee=function(r){var e=r.style,i={x:parseInt(e.left)||0,y:parseInt(e.top)||0};if(!i.x&&!i.x){var t=window.getComputedStyle(r);return{x:parseInt(t.left)||0,y:parseInt(t.top)||0}}return i},Ce=function(n,r){return r?Te(n):Ee(n)},xe=function(n){var r=n.element,e=n.edges,i=n.elementRect,t=n.containerRect,s=n.elementPos,a=n.useTransform;e.includes("top")&&O(r,{y:s.y+t.top-i.top,x:s.x},a),e.includes("left")&&O(r,{y:s.y,x:s.x+t.left-i.left},a),e.includes("bottom")&&O(r,{y:s.y+t.bottom-i.bottom,x:s.x},a),e.includes("right")&&O(r,{y:s.y,x:s.x+t.right-i.right},a)},re=function(n){var r=n.computedStyle,e=n.node,i=r.position,t=i==="absolute"||i==="relative"||i==="fixed";!(e instanceof Document)&&!t&&(e.style.position="relative")},we=function(n){var r=n.shiftKey,e=n.keyboardDragSpeed,i=n.zoom,t=n.key,s=n.dragKeys,a=n.scrollDiff,l=n.canScroll,c=n.scrollCallback,d={x:0,y:0},S=r?e*4*i:e*i;return s.left.includes(t)&&(d.x=a.x||-S,!r&&!a.x&&l&&c(["left"],e)),s.right.includes(t)&&(d.x=a.x||S,!r&&!a.x&&l&&c(["right"],e)),s.up.includes(t)&&(d.y=a.y||-S,!r&&!a.y&&l&&c(["top"],e)),s.down.includes(t)&&(d.y=a.y||S,!r&&!a.y&&l&&c(["bottom"],e)),d},ke=function(n){var r=n.element,e=n.force,i=n.multiSelectionToggle,t=n.SelectedSet,s=n.hoverClassName;r.classList.contains(s)&&!e||(t.has(r)?i&&t.delete(r):t.add(r),r.classList.add(s))},Me=function(n){var r=n.element,e=n.force,i=n.SelectedSet,t=n.PrevSelectedSet,s=n.hoverClassName;if(!r.classList.contains(s)&&!e)return!1;var a=i.has(r),l=t.has(r);a&&!l?i.delete(r):!a&&l&&i.add(r),r.classList.remove(s)},N=function(r,e,i){return console.warn('[DragSelect] TypeIssue: setting "'.concat(r,'" is not of type "').concat(e,'".'))},f=function(r,e,i,t){if(e===void 0)return i?o({},r,t):{};if(e===null)return o({},r,null);var s=!0,a=!1,l=typeof t=="string";l&&(s=typeof e=="string"||e instanceof String),l&&!s&&(a=!0,N(r,"string"));var c=!Number.isNaN(t)&&typeof t=="number";c&&(s=!Number.isNaN(e)&&typeof e=="number"),c&&!s&&(a=!0,N(r,"number"));var d=Object.prototype.toString.call(t)==="[object Object]";d&&(s=Object.prototype.toString.call(e)==="[object Object]"),d&&!s&&(a=!0,N(r,"object"));var S=typeof t=="boolean";S&&(s=typeof e=="boolean"),S&&!s&&(a=!0,N(r,"boolean"));var b=Array.isArray(t);b&&(s=Array.isArray(e)),b&&!s&&(a=!0,N(r,"array"));var L=a||i;return r==="dragKeys"&&s?o({},r,Object.assign(t,e)):r==="dragKeys"&&!s?L?o({},r,t):{}:(r==="dropZones"&&s&&new Set(e.map(function(I){return I.id})).size!==e.length&&console.warn('[DragSelect] UniqueConstraintsIssue: setting "dropZones" contains duplicate ids.'),s?o({},r,e):L?o({},r,t):{})},Ve=function(n,r){return u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u(u({},f("area",n.area,r,document)),f("selectables",n.selectables,r,null)),f("autoScrollSpeed",n.autoScrollSpeed,r,5)),f("overflowTolerance",n.overflowTolerance,r,{x:25,y:25})),f("zoom",n.zoom,r,1)),f("customStyles",n.customStyles,r,!1)),f("multiSelectMode",n.multiSelectMode,r,!1)),f("multiSelectToggling",n.multiSelectToggling,r,!0)),f("multiSelectKeys",n.multiSelectKeys,r,["Control","Shift","Meta"])),f("selector",n.selector,r,null)),f("selectionThreshold",n.selectionThreshold,r,0)),f("draggability",n.draggability,r,!0)),f("immediateDrag",n.immediateDrag,r,!0)),f("keyboardDrag",n.keyboardDrag,r,!0)),f("dragKeys",n.dragKeys,r,{up:["ArrowUp"],down:["ArrowDown"],left:["ArrowLeft"],right:["ArrowRight"]})),f("keyboardDragSpeed",n.keyboardDragSpeed,r,10)),f("useTransform",n.useTransform,r,!0)),f("refreshMemoryRate",n.refreshMemoryRate,r,80)),f("dropZones",n.dropZones,r,[])),f("dropInsideThreshold",n.dropInsideThreshold,r,1)),f("dropTargetThreshold",n.dropTargetThreshold,r,0)),f("usePointerEvents",n.usePointerEvents,r,!1)),f("hoverClass",n.hoverClass,r,"ds-hover")),f("selectableClass",n.selectableClass,r,"ds-selectable")),f("selectedClass",n.selectedClass,r,"ds-selected")),f("selectorClass",n.selectorClass,r,"ds-selector")),f("selectorAreaClass",n.selectorAreaClass,r,"ds-selector-area")),f("droppedTargetClass",n.droppedTargetClass,r,"ds-dropped-target")),f("droppedInsideClass",n.droppedInsideClass,r,"ds-dropped-inside")),f("droppableClass",n.droppableClass,r,"ds-droppable")),f("dropZoneClass",n.dropZoneClass,r,"ds-dropzone")),f("dropZoneReadyClass",n.dropZoneReadyClass,r,"ds-dropzone-ready")),f("dropZoneTargetClass",n.dropZoneTargetClass,r,"ds-dropzone-target")),f("dropZoneInsideClass",n.dropZoneInsideClass,r,"ds-dropzone-inside"))},K=function(n,r){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=n;if(e>0){var t=(n.right-n.left)*e,s=(n.bottom-n.top)*e;i={left:n.left+t,right:n.right-t,top:n.top+s,bottom:n.bottom-s}}return i.left<r.right&&i.right>r.left&&i.top<r.bottom&&i.bottom>r.top},ne=function(n){var r=n.element,e=n.posDirection,i=n.containerRect,t=n.useTransform,s=Ce(r,t),a=P(s,"+",e);O(r,a,t);var l=r.getBoundingClientRect(),c=ee({elementRect:l,containerRect:i});xe({element:r,edges:c,elementRect:l,containerRect:i,elementPos:a,useTransform:t})},Ne=function(n,r){window.removeEventListener("resize",r),window.removeEventListener("scroll",r),n.disconnect()},Ke=function(n,r,e){if(!!r.length){var i=document&&document.documentElement&&document.documentElement.scrollTop&&document.documentElement,t=n instanceof Document?i||document.body:n,s=r.includes("top")&&t.scrollTop>0,a=r.includes("bottom")&&t.scrollTop<t.scrollHeight,l=r.includes("left")&&t.scrollLeft>0,c=r.includes("right")&&t.scrollLeft<t.scrollWidth;s&&(t.scrollTop-=1*e),a&&(t.scrollTop+=1*e),l&&(t.scrollLeft-=1*e),c&&(t.scrollLeft+=1*e)}},O=function(n,r,e){if(e){var i=n.style.transform;n.style.transform="translate3d(".concat(r.x,"px,").concat(r.y,"px,1px) ").concat(i.replace(/translate.*?\)/g,""))}else n.style.left="".concat(r.x,"px"),n.style.top="".concat(r.y,"px");return n},Oe=function(n){for(var r=n.subscribe,e=n.publish,i=n.Interaction,t=n.SelectedSet,s=n.DropZones,a={"Selected:added":[{name:"elementselect"}],"Selected:removed":[{name:"elementunselect"}],"Area:scroll":[{name:"autoscroll"}],"Interaction:start":[{name:"dragstart"}],"Interaction:update":[{name:"dragmove",condition:function(b){return b.event}}],"Interaction:end":[{name:"callback",extraData:function(){var b=s.getTarget();return u({},b?{dropTarget:b.toObject()}:{})}}]},l=function(){var b=j(d[c],2),L=b[0],I=b[1];["pre",!1].forEach(function(x){return r(x?"".concat(L,":").concat(x):L,function(D){return I.forEach(function(T){return(!T.condition||T.condition(D))&&e(x?"".concat(x).concat(T.name):T.name,u(u({items:t.elements,isDragging:i.isDragging},D),T.extraData?T.extraData(D):{}))})})})},c=0,d=Object.entries(a);c<d.length;c++)l()},w=function(n){return n?!Array.isArray(n)&&(n instanceof HTMLElement||n instanceof SVGElement)?[n]:C(new Set(C(n))):[]},se=function(n,r){n.style.left="".concat(r.left,"px"),n.style.top="".concat(r.top,"px"),n.style.width="".concat(r.width,"px"),n.style.height="".concat(r.height,"px")},Re=function(){function n(r){var e=this,i=r.DS;h(this,n),o(this,"DS",void 0),o(this,"_observers",void 0),o(this,"_node",void 0),o(this,"_parentNodes",void 0),o(this,"_computedStyle",void 0),o(this,"_computedBorder",void 0),o(this,"_rect",void 0),o(this,"setArea",function(t){e.reset(),e._node=t,re({computedStyle:e.computedStyle,node:e._node}),setTimeout(function(){e.DS.PubSub.publish("Area:modified:pre",{item:e}),e.reset(),e.DS.PubSub.publish("Area:modified",{item:e})})}),o(this,"start",function(){e._observers=J(e.parentNodes,Q(function(t){e.DS.PubSub.publish("Area:modified:pre",{event:t,item:e}),e.reset(),e.DS.PubSub.publish("Area:modified",{event:t,item:e})},60))}),o(this,"reset",function(){e._computedStyle=void 0,e._rect=void 0,e._computedBorder=void 0,e._parentNodes=void 0}),o(this,"stop",function(){e._observers.cleanup(),e.reset()}),o(this,"scroll",function(t,s){var a={scroll_directions:t,scroll_multiplier:s};e.DS.PubSub.publish("Area:scroll:pre",a),Ke(e._node,t,s),e.DS.PubSub.publish("Area:scroll",a)}),this.DS=i,this.setArea(this.DS.stores.SettingsStore.s.area),this.DS.PubSub.subscribe("Settings:updated:area",function(t){var s=t.settings;e.setArea(s.area)}),this.DS.PubSub.subscribe("Interaction:init",this.start),this.DS.PubSub.subscribe("Interaction:end",this.reset)}return p(n,[{key:"HTMLNode",get:function(){return this._node}},{key:"computedBorder",get:function(){return this._computedBorder?this._computedBorder:{top:parseInt(this.computedStyle.borderTopWidth),bottom:parseInt(this.computedStyle.borderBottomWidth),left:parseInt(this.computedStyle.borderLeftWidth),right:parseInt(this.computedStyle.borderRightWidth)}}},{key:"computedStyle",get:function(){return this._computedStyle?this._computedStyle:this.HTMLNode instanceof Document?this._computedStyle=window.getComputedStyle(this.HTMLNode.body||this.HTMLNode.documentElement):this._computedStyle=window.getComputedStyle(this.HTMLNode)}},{key:"rect",get:function(){return this._rect?this._rect:this._rect=Ie(this.HTMLNode,this.DS.stores.SettingsStore.s.zoom)}},{key:"parentNodes",get:function(){return this._parentNodes?this._parentNodes:this._parentNodes=F(this.HTMLNode)}}]),n}(),Ze=function(){function n(r){var e=this,i=r.DS;h(this,n),o(this,"_prevCursorPos",void 0),o(this,"_prevScrollPos",void 0),o(this,"_elements",[]),o(this,"_dragKeys",void 0),o(this,"_dragKeysFlat",[]),o(this,"assignDragkeys",function(){e._dragKeys={up:e.DS.stores.SettingsStore.s.dragKeys.up.map(function(t){return t.toLowerCase()}),down:e.DS.stores.SettingsStore.s.dragKeys.down.map(function(t){return t.toLowerCase()}),left:e.DS.stores.SettingsStore.s.dragKeys.left.map(function(t){return t.toLowerCase()}),right:e.DS.stores.SettingsStore.s.dragKeys.right.map(function(t){return t.toLowerCase()})},e._dragKeysFlat=[].concat(C(e._dragKeys.up),C(e._dragKeys.down),C(e._dragKeys.left),C(e._dragKeys.right))}),o(this,"keyboardDrag",function(t){var s=t.event,a=t.key,l=a.toLowerCase();if(!(!e.DS.stores.SettingsStore.s.keyboardDrag||!e._dragKeysFlat.includes(l)||!e.DS.SelectedSet.size||!e.DS.stores.SettingsStore.s.draggability||e.DS.continue)){var c={event:s,isDragging:!0,isDraggingKeyboard:!0};e.DS.publish(["Interaction:start:pre","Interaction:start"],c),e._elements=e.DS.getSelection(),e.handleZIndex(!0);var d=we({shiftKey:e.DS.stores.KeyStore.currentValues.includes("shift"),keyboardDragSpeed:e.DS.stores.SettingsStore.s.keyboardDragSpeed,zoom:e.DS.stores.SettingsStore.s.zoom,key:l,scrollCallback:e.DS.Area.scroll,scrollDiff:e._scrollDiff,canScroll:e.DS.stores.ScrollStore.canScroll,dragKeys:e._dragKeys});e._elements.forEach(function(S){return ne({element:S,posDirection:d,containerRect:e.DS.SelectorArea.rect,useTransform:e.DS.stores.SettingsStore.s.useTransform})}),e.DS.publish(["Interaction:update:pre","Interaction:update"],c)}}),o(this,"keyboardEnd",function(t){var s=t.event,a=t.key,l=a.toLowerCase();if(!(!e.DS.stores.SettingsStore.s.keyboardDrag||!e._dragKeysFlat.includes(l)||!e.DS.SelectedSet.size||!e.DS.stores.SettingsStore.s.draggability)){var c={event:s,isDragging:e.DS.stores.SettingsStore.s.draggability,isDraggingKeyboard:!0};e.DS.publish(["Interaction:end:pre","Interaction:end"],c)}}),o(this,"start",function(t){var s=t.isDragging,a=t.isDraggingKeyboard;!s||a||(e._prevCursorPos=null,e._prevScrollPos=null,e._elements=e.DS.getSelection(),e.handleZIndex(!0))}),o(this,"stop",function(t){t!=null&&t.isKeyboard||(e._prevCursorPos=null,e._prevScrollPos=null,e.handleZIndex(!1),e._elements=[])}),o(this,"update",function(t){var s=t.isDragging,a=t.isDraggingKeyboard;if(!(!s||!e._elements.length||a||e.DS.continue)){var l=P(e._cursorDiff,"+",e._scrollDiff);e._elements.forEach(function(c){return ne({element:c,posDirection:l,containerRect:e.DS.SelectorArea.rect,useTransform:e.DS.stores.SettingsStore.s.useTransform})})}}),o(this,"handleZIndex",function(t){e._elements.forEach(function(s){return s.style.zIndex="".concat((parseInt(s.style.zIndex)||0)+t?9999:-9998)})}),this.DS=i,this.DS.subscribe("Settings:updated:dragKeys",this.assignDragkeys),this.assignDragkeys(),this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:end",this.stop),this.DS.subscribe("Interaction:update",this.update),this.DS.subscribe("KeyStore:down",this.keyboardDrag),this.DS.subscribe("KeyStore:up",this.keyboardEnd)}return p(n,[{key:"_cursorDiff",get:function(){var e=this.DS.stores.PointerStore.currentVal,i=this._prevCursorPos?P(e,"-",this._prevCursorPos):{x:0,y:0};return this._prevCursorPos=e,i}},{key:"_scrollDiff",get:function(){var e=this.DS.stores.ScrollStore.currentVal,i=this._prevScrollPos?P(e,"-",this._prevScrollPos):{x:0,y:0};return this._prevScrollPos=e,i}}]),n}(),He=function(){function n(r){var e=this,i=r.DS,t=r.id,s=r.element,a=r.droppables;h(this,n),o(this,"id",void 0),o(this,"element",void 0),o(this,"_droppables",void 0),o(this,"_rect",void 0),o(this,"_observers",void 0),o(this,"_timeout",void 0),o(this,"_itemsDropped",[]),o(this,"_itemsInside",void 0),o(this,"setReadyClasses",function(l){if(!e.isDestroyed){var c=e.droppables.filter(function(d){return e.DS.SelectedSet.has(d)});!c.length||(c.forEach(function(d){d.classList[l]("".concat(e.Settings.droppableClass)),d.classList[l]("".concat(e.Settings.droppableClass,"-").concat(e.id))}),e.element.classList[l]("".concat(e.Settings.dropZoneReadyClass)))}}),o(this,"handleNoDrop",function(){var l;e.isDestroyed||(e.DS.SelectedSet.forEach(function(c){c.classList.remove(e.Settings.droppedTargetClass),c.classList.remove("".concat(e.Settings.droppedTargetClass,"-").concat(e.id))}),e._itemsDropped=e._itemsDropped.filter(function(c){return!e.DS.SelectedSet.has(c)}),(l=e._itemsDropped)!==null&&l!==void 0&&l.length||e.element.classList.remove("".concat(e.Settings.dropZoneTargetClass)))}),o(this,"handleDrop",function(){var l,c,d;e.isDestroyed||(e._itemsDropped=C(new Set([].concat(C(e._itemsDropped),C((l=e.droppables)===null||l===void 0?void 0:l.filter(function(S){return e.DS.SelectedSet.has(S)}))))),(c=e._itemsDropped)===null||c===void 0||c.forEach(function(S){S.classList.add("".concat(e.Settings.droppedTargetClass)),S.classList.add("".concat(e.Settings.droppedTargetClass,"-").concat(e.id))}),(d=e._itemsDropped)!==null&&d!==void 0&&d.length&&e.element.classList.add("".concat(e.Settings.dropZoneTargetClass)))}),o(this,"handleItemsInsideClasses",function(){var l=!1;e.droppables.forEach(function(c){e.itemsInside.includes(c)?(c.classList.add("".concat(e.Settings.droppedInsideClass)),c.classList.add("".concat(e.Settings.droppedInsideClass,"-").concat(e.id)),l=!0):(c.classList.remove("".concat(e.Settings.droppedInsideClass,"-").concat(e.id)),c.className.includes("".concat(e.Settings.droppedInsideClass,"-"))||c.classList.remove("".concat(e.Settings.droppedInsideClass)))}),l?e.element.classList.add("".concat(e.Settings.dropZoneInsideClass)):e.element.classList.remove("".concat(e.Settings.dropZoneInsideClass))}),o(this,"start",function(l){var c=l.isDragging;!c||e.isDestroyed||e.setReadyClasses("add")}),o(this,"stop",function(l){var c=l.isDragging;!c||e.isDestroyed||(e.setReadyClasses("remove"),e.handleItemsInsideClasses())}),o(this,"toObject",function(){return{id:e.id,element:e.element,droppables:e.droppables,itemsDropped:e.itemsDropped,itemsInside:e.itemsInside}}),this.DS=i,this.Settings=i.stores.SettingsStore.s,this.id=t,this.element=s,a&&(this.droppables=w(a)),this.element.classList.add("".concat(this.Settings.dropZoneClass)),this.DS.subscribe("Settings:updated:dropZoneClass",function(l){var c=l.settings;e.element.classList.remove(c["dropZoneClass:pre"]),e.element.classList.add(c.dropZoneClass)}),this._observers=J(this.parentNodes,Q(function(){return e._rect=null},this.Settings.refreshMemoryRate)),this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:end",this.stop)}return p(n,[{key:"destroy",value:function(){var e=this;this._observers.cleanup(),this.element.classList.remove("".concat(this.Settings.dropZoneClass)),this.element.classList.remove("".concat(this.Settings.dropZoneTargetClass)),this.element.classList.remove("".concat(this.Settings.dropZoneReadyClass)),this.droppables.forEach(function(i){i.classList.remove("".concat(e.Settings.droppedTargetClass)),i.classList.remove("".concat(e.Settings.droppedTargetClass,"-").concat(e.id)),i.classList.remove("".concat(e.Settings.droppableClass)),i.classList.remove("".concat(e.Settings.droppableClass,"-").concat(e.id))}),this.DS.unsubscribe("Interaction:start",this.start),this.DS.unsubscribe("Interaction:end",this.stop),this.element=null,this.droppables=null,this.id=null,this._itemsDropped=null,this._itemsInside=null,this.isDestroyed=!0}},{key:"rect",get:function(){return this.isDestroyed?null:this._rect?this._rect:this._rect=this.element.getBoundingClientRect()}},{key:"itemsDropped",get:function(){return this.isDestroyed?null:this._itemsDropped}},{key:"itemsInside",get:function(){var e=this;return this.isDestroyed?null:this._itemsInside?this._itemsInside:(this._itemsInside=this.droppables.flatMap(function(i){return K(e.DS.SelectableSet.rects.get(i),e.rect,e.Settings.dropInsideThreshold)?[i]:[]}),this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(function(){return e._itemsInside=null},this.Settings.refreshMemoryRate),this._itemsInside)}},{key:"parentNodes",get:function(){return this._parentNodes?this._parentNodes:this._parentNodes=F(this.element)}},{key:"droppables",get:function(){return this._droppables?this._droppables:this.DS.SelectableSet.elements},set:function(e){this._droppables=e}}]),n}(),ze=function n(r){var e=this,i=r.DS;h(this,n),o(this,"_zoneByElement",new Map),o(this,"_zoneById",new Map),o(this,"_zonesByDroppable",new Map),o(this,"_zones",void 0),o(this,"setDropZones",function(t){var s=t.dropZones;!s||(e._zones&&e._zones.forEach(function(a){return a.destroy()}),e._zones=s.map(function(a){return new He(u({DS:e.DS},a))}),e._zones.forEach(function(a){e._zoneByElement.set(a.element,a),e._zoneById.set(a.id,a),a.droppables.forEach(function(l){var c=e._zonesByDroppable.get(l);if(!(c!=null&&c.length))return e._zonesByDroppable.set(l,[a]);e._zonesByDroppable.set(l,C(new Set([].concat(C(c),[a]))))})}))}),o(this,"_handleDrop",function(t){e._zones.forEach(function(s){s!==t&&s.handleNoDrop()}),t&&t.handleDrop()}),o(this,"_getZoneByElementsFromPoint",function(t,s){for(var a=s.x,l=s.y,c=0,d=t.length;c<d;c++){var S=e._zoneByElement.get(t[c]);if(S&&K(S.rect,{left:a,right:a,top:l,bottom:l},Math.min(e.Settings.dropTargetThreshold,.5)))return S}}),o(this,"stop",function(t){var s=t.isDragging;if(!!s){var a=e.getTarget();e._handleDrop(a)}}),o(this,"getItemsDroppedById",function(t){var s=e._zoneById.get(t);return s?s.itemsDropped:console.warn("[DragSelect] No zone found (id: ".concat(t,")"))}),o(this,"getItemsInsideById",function(t,s){var a=e._zoneById.get(t);if(!a)return console.warn("[DragSelect] No zone found (id: ".concat(t,")"));var l=a.itemsInside;return s&&a.handleItemsInsideClasses(),l}),o(this,"getTarget",function(t){var s;if(!!((s=e._zones)!==null&&s!==void 0&&s.length)){var a=(t==null?void 0:t.x)||e.DS.stores.PointerStore.currentVal.x,l=(t==null?void 0:t.y)||e.DS.stores.PointerStore.currentVal.y,c=document.elementsFromPoint(a,l);return e._getZoneByElementsFromPoint(c,{x:a,y:l})}}),this.DS=i,this.Settings=i.stores.SettingsStore.s,this.DS.subscribe("Settings:updated:dropZones",function(t){var s=t.settings;return e.setDropZones(s)}),this.setDropZones({dropZones:this.DS.stores.SettingsStore.s.dropZones}),this.DS.subscribe("Interaction:end",this.stop)},je=function(){function n(r){var e=this,i=r.DS;h(this,n),o(this,"isInteracting",void 0),o(this,"isDragging",void 0),o(this,"init",function(){return e.DS.publish("Interaction:init:pre",{})}),o(this,"_init",function(){e.stop(),e.Settings.usePointerEvents?e.DS.Area.HTMLNode.addEventListener("pointerdown",e.start,{passive:!1}):e.DS.Area.HTMLNode.addEventListener("mousedown",e.start),e.DS.Area.HTMLNode.addEventListener("touchstart",e.start,{passive:!1}),e.DS.publish("Interaction:init",{})}),o(this,"start",function(t){return e.DS.publish("Interaction:start:pre",{event:t,isDragging:e.isDragging})}),o(this,"_start",function(t){t.type==="touchstart"&&t.preventDefault(),e._canInteract(t)&&(e.isInteracting=!0,e.isDragging=e.isDragEvent(t),e.DS.publish("Interaction:start",{event:t,isDragging:e.isDragging}),e.Settings.usePointerEvents?(document.addEventListener("pointerup",e.reset),document.addEventListener("pointercancel",e.reset)):document.addEventListener("mouseup",e.reset),document.addEventListener("touchend",e.reset))}),o(this,"isDragEvent",function(t){var s=t.target.closest(".".concat(e.Settings.selectableClass));return!e.Settings.draggability||e.DS.stores.KeyStore.isMultiSelectKeyPressed(t)||!s?!1:(e.Settings.immediateDrag&&(e.DS.SelectedSet.size?e.DS.SelectedSet.has(s)||(e.DS.SelectedSet.clear(),e.DS.SelectedSet.add(s)):e.DS.SelectedSet.add(s)),!!e.DS.SelectedSet.has(s))}),o(this,"onClick",function(t){var s=t.event;if(!!e._canInteract(s)&&!(s.detail>0)){var a=e.DS,l=a.stores,c=l.PointerStore,d=l.KeyStore,S=a.SelectableSet,b=a.SelectedSet;c.start(s);var L=s.target;!S.has(L)||(d.isMultiSelectKeyPressed(s)||b.clear(),b.toggle(L),e.reset())}}),o(this,"stop",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.DS.Area.HTMLNode;e.isInteracting=!1,e.isDragging=!1,e.Settings.usePointerEvents?(t.removeEventListener("pointerdown",e.start,{passive:!1}),document.removeEventListener("pointerup",e.reset),document.removeEventListener("pointercancel",e.reset)):(t.removeEventListener("mousedown",e.start),document.removeEventListener("mouseup",e.reset)),t.removeEventListener("touchstart",e.start,{passive:!1}),document.removeEventListener("touchend",e.reset)}),o(this,"update",function(t){var s=t.event,a=t.scroll_directions,l=t.scroll_multiplier;e.isInteracting&&e.DS.publish(["Interaction:update:pre","Interaction:update"],{event:s,scroll_directions:a,scroll_multiplier:l,isDragging:e.isDragging})}),o(this,"reset",function(t){return e.DS.publish("Interaction:end:pre",{event:t,isDragging:e.isDragging})}),o(this,"_reset",function(t){var s=e.isDragging;e.stop(),e.init(),e.DS.publish("Interaction:end",{event:t,isDragging:s})}),this.DS=i,this.Settings=i.stores.SettingsStore.s,this.DS.subscribe("Settings:updated:area",function(t){var s=t.settings;e.stop(s["area:pre"]),e.init()}),this.DS.subscribe("PointerStore:updated",this.update),this.DS.subscribe("Selectable:click",this.onClick),this.DS.subscribe("Selectable:pointer",function(t){var s=t.event;return e.start(s)}),this.DS.subscribe("Interaction:start:pre",function(t){var s=t.event;return e._start(s)}),this.DS.subscribe("Interaction:init:pre",this._init),this.DS.subscribe("Interaction:end:pre",function(t){var s=t.event;return e._reset(s)}),this.DS.subscribe("Area:scroll",this.update)}return p(n,[{key:"_canInteract",value:function(e){var i=e.clientX===0&&e.clientY===0&&e.detail===0&&e.target;return!(e.button===2||this.isInteracting||e.target&&!this.DS.SelectorArea.isInside(e.target)||!i&&!this.DS.SelectorArea.isClicked(e))}}]),n}(),Be=function n(r){var e=this,i=r.DS;h(this,n),o(this,"subscribers",{}),o(this,"subscribe",function(t,s){return Array.isArray(e.subscribers[t])||(e.subscribers[t]=[]),e.subscribers[t].push(s),e.subscribers[t].length-1}),o(this,"unsubscribe",function(t,s,a){a>=0?e.subscribers[t].splice(a,1):s&&(e.subscribers[t]=e.subscribers[t].filter(function(l){return l!==s}))}),o(this,"publish",function(t,s){Array.isArray(t)?t.forEach(function(a){return e._publish(a,s)}):e._publish(t,s)}),o(this,"_publish",function(t,s){var a=e.subscribers[t];!Array.isArray(a)||(t.includes(":pre")?e._handlePrePublish(a,s):e._handlePublish(a,s))}),o(this,"_handlePublish",function(t,s){for(var a=0,l=t.length;a<l;a++){if(e.DS.stopped)return;t[a](s)}}),o(this,"_handlePrePublish",function(t,s){for(var a=t.length;a--;){if(e.DS.stopped)return;t[a](s)}}),this.DS=i},$e=function(n){U(e,n);var r=Y(e);function e(i){var t,s=i.DS;return h(this,e),t=r.call(this),o(A(t),"_rects",void 0),o(A(t),"_timeout",void 0),o(A(t),"init",function(){return w(t.Settings.selectables).forEach(function(a){return t.add(a)})}),o(A(t),"clear",function(){return t.forEach(function(a){return t.delete(a)})}),o(A(t),"_onClick",function(a){return t.DS.publish(["Selectable:click:pre","Selectable:click"],{event:a})}),o(A(t),"_onPointer",function(a){return t.DS.publish(["Selectable:pointer:pre","Selectable:pointer"],{event:a})}),o(A(t),"addAll",function(a){return a.forEach(function(l){return t.add(l)})}),o(A(t),"deleteAll",function(a){return a.forEach(function(l){return t.delete(l)})}),t.DS=s,t.Settings=s.stores.SettingsStore.s,t.DS.subscribe("Interaction:init",t.init),t.DS.PubSub.subscribe("Settings:updated:selectables",function(){t.clear(),t.init()}),t.DS.subscribe("Settings:updated:selectableClass",function(a){var l=a.settings;t.forEach(function(c){c.classList.remove(l["selectableClass:pre"]),c.classList.add(l.selectableClass)})}),t}return p(e,[{key:"add",value:function(t){if(!E(_(e.prototype),"has",this).call(this,t)){var s={items:this.elements,item:t};return this.DS.publish("Selectable:added:pre",s),t.classList.add(this.Settings.selectableClass),t.addEventListener("click",this._onClick),this.Settings.usePointerEvents?t.addEventListener("pointerdown",this._onPointer,{passive:!1}):t.addEventListener("mousedown",this._onPointer),t.addEventListener("touchstart",this._onPointer,{passive:!1}),this.Settings.draggability&&!this.Settings.useTransform&&re({computedStyle:window.getComputedStyle(t),node:t}),this.DS.publish("Selectable:added",s),E(_(e.prototype),"add",this).call(this,t)}}},{key:"delete",value:function(t){if(!!E(_(e.prototype),"has",this).call(this,t)){var s={items:this.elements,item:t};return this.DS.publish("Selectable:removed:pre",s),t.classList.remove(this.Settings.selectableClass),t.classList.remove(this.Settings.hoverClass),t.removeEventListener("click",this._onClick),this.Settings.usePointerEvents?t.removeEventListener("pointerdown",this._onPointer,{passive:!1}):t.removeEventListener("mousedown",this._onPointer),t.removeEventListener("touchstart",this._onPointer,{passive:!1}),this.DS.publish("Selectable:removed",s),E(_(e.prototype),"delete",this).call(this,t)}}},{key:"elements",get:function(){return Array.from(this.values())}},{key:"rects",get:function(){var t=this;return this._rects?this._rects:(this._rects=new Map,this.forEach(function(s){return t._rects.set(s,s.getBoundingClientRect())}),this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(function(){return t._rects=null},this.Settings.refreshMemoryRate),this._rects)}}]),e}(H(Set)),We=function(n){U(e,n);var r=Y(e);function e(i){var t,s=i.DS;return h(this,e),t=r.call(this),o(A(t),"clear",function(){return t.forEach(function(a){return t.delete(a)})}),o(A(t),"addAll",function(a){return a.forEach(function(l){return t.add(l)})}),o(A(t),"deleteAll",function(a){return a.forEach(function(l){return t.delete(l)})}),t.DS=s,t}return p(e,[{key:"add",value:function(t){if(!E(_(e.prototype),"has",this).call(this,t)){var s={items:this.elements,item:t};return this.DS.publish("Selected:added:pre",s),E(_(e.prototype),"add",this).call(this,t),t.classList.add(this.DS.stores.SettingsStore.s.selectedClass),t.style.zIndex="".concat((parseInt(t.style.zIndex)||0)+1),this.DS.publish("Selected:added",s),this}}},{key:"delete",value:function(t){if(!!E(_(e.prototype),"has",this).call(this,t)){var s={items:this.elements,item:t};this.DS.publish("Selected:removed:pre",s);var a=E(_(e.prototype),"delete",this).call(this,t);return t.classList.remove(this.DS.stores.SettingsStore.s.selectedClass),t.style.zIndex="".concat((parseInt(t.style.zIndex)||0)-1),this.DS.publish("Selected:removed",s),a}}},{key:"toggle",value:function(t){return this.has(t)?this.delete(t):this.add(t),t}},{key:"elements",get:function(){return Array.from(this.values())}}]),e}(H(Set)),Ge=function(){function n(r){var e=this,i=r.DS;h(this,n),o(this,"_prevSelectedSet",void 0),o(this,"start",function(t){var s=t.event,a=t.isDragging;a||(e._storePrevious(s),e._handleInsideSelection(!0,s))}),o(this,"update",function(t){var s=t.isDragging;s||e.DS.continue||e._handleInsideSelection()}),o(this,"_handleInsideSelection",function(t,s){var a=e.DS,l=a.SelectableSet,c=a.SelectorArea,d=a.Selector,S=l.rects,b=[],L=[],I=ye(S),x;try{for(I.s();!(x=I.n()).done;){var D=j(x.value,2),T=D[0],R=D[1];!c.isInside(T,R)||(K(R,d.rect,e.Settings.selectionThreshold)?b.push(T):L.push(T))}}catch(k){I.e(k)}finally{I.f()}var G=e.DS.stores.KeyStore.isMultiSelectKeyPressed(s)&&e.Settings.multiSelectToggling;e.DS.continue||(b.forEach(function(k){return ke({element:k,force:t,multiSelectionToggle:G,SelectedSet:e.DS.SelectedSet,hoverClassName:e.Settings.hoverClass})}),L.forEach(function(k){return Me({element:k,force:t,SelectedSet:e.DS.SelectedSet,hoverClassName:e.Settings.hoverClass,PrevSelectedSet:e._prevSelectedSet})}))}),this.DS=i,this.Settings=this.DS.stores.SettingsStore.s,this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:update",this.update)}return p(n,[{key:"_storePrevious",value:function(e){var i=this.DS,t=i.stores.KeyStore,s=i.SelectedSet;t.isMultiSelectKeyPressed(e)?this._prevSelectedSet=new Set(s):this._prevSelectedSet=new Set}}]),n}(),Ue=function(){function n(r){var e=this,i=r.DS;h(this,n),o(this,"_rect",void 0),o(this,"attachSelector",function(){var t,s;e.HTMLNode&&(t=e.DS.SelectorArea)!==null&&t!==void 0&&t.HTMLNode&&e.DS.SelectorArea.HTMLNode.removeChild(e.HTMLNode),e.HTMLNode=e.DS.stores.SettingsStore.s.selector||Pe(e.DS.stores.SettingsStore.s.customStyles),e.HTMLNode.classList.add(e.DS.stores.SettingsStore.s.selectorClass),e.HTMLNode&&(s=e.DS.SelectorArea)!==null&&s!==void 0&&s.HTMLNode&&e.DS.SelectorArea.HTMLNode.appendChild(e.HTMLNode)}),o(this,"start",function(t){var s=t.isDragging;if(!s){var a=e.DS.stores.PointerStore,l=a.initialValArea;se(e.HTMLNode,q(l,1)),e.HTMLNode.style.display="block",e._rect=null}}),o(this,"stop",function(){e.HTMLNode.style.width="0",e.HTMLNode.style.height="0",e.HTMLNode.style.display="none"}),o(this,"update",function(t){var s=t.isDragging;if(!(s||e.DS.continue)){var a=e.DS.stores,l=a.ScrollStore,c=a.PointerStore,d=Le({scrollAmount:l.scrollAmount,initialPointerPos:c.initialValArea,pointerPos:c.currentValArea});se(e.HTMLNode,d),e._rect=null}}),this.DS=i,this.DS.subscribe("Settings:updated:selectorClass",function(t){var s=t.settings;e.HTMLNode.classList.remove(s["selectorClass:pre"]),e.HTMLNode.classList.add(s.selectorClass)}),this.DS.subscribe("Settings:updated:selector",this.attachSelector),this.DS.subscribe("Settings:updated:customStyles",this.attachSelector),this.attachSelector(),this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:update",this.update),this.DS.subscribe("Interaction:end",this.stop)}return p(n,[{key:"rect",get:function(){return this._rect?this._rect:this._rect=this.HTMLNode.getBoundingClientRect()}}]),n}(),Xe=function(){function n(r){var e=this,i=r.DS;h(this,n),o(this,"_scrollInterval",void 0),o(this,"_rect",void 0),o(this,"currentEdges",[]),o(this,"start",function(){return e.applyElements("append")}),o(this,"applyElements",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"append",s=document.body?"body":"documentElement",a="".concat(t,"Child");e.HTMLNode[a](e.DS.Selector.HTMLNode),document[s][a](e.HTMLNode)}),o(this,"updatePos",function(){e._rect=null;var t=e.DS.Area.rect,s=e.DS.Area.computedBorder,a=e.HTMLNode.style,l="".concat(t.top+s.top,"px"),c="".concat(t.left+s.left,"px"),d="".concat(t.width,"px"),S="".concat(t.height,"px");a.top!==l&&(a.top=l),a.left!==c&&(a.left=c),a.width!==d&&(a.width=d),a.height!==S&&(a.height=S)}),o(this,"stop",function(t){e.stopAutoScroll(),t&&e.applyElements("remove")}),o(this,"startAutoScroll",function(){e.currentEdges=[],e._scrollInterval=setInterval(function(){return e.handleAutoScroll()},16)}),o(this,"handleAutoScroll",function(){if(!e.DS.continue){var t=e.DS,s=t.stores.PointerStore,a=t.Area;e.currentEdges=ee({elementRect:q(s.currentVal),containerRect:e.rect,tolerance:e.DS.stores.SettingsStore.s.overflowTolerance}),e.currentEdges.length&&a.scroll(e.currentEdges,e.DS.stores.SettingsStore.s.autoScrollSpeed)}}),o(this,"stopAutoScroll",function(){e.currentEdges=[],clearInterval(e._scrollInterval)}),o(this,"isInside",function(t,s){return e.DS.Area.HTMLNode.contains(t)&&e.DS.stores.ScrollStore.canScroll?!0:K(e.rect,s||t.getBoundingClientRect())}),this.DS=i,this.HTMLNode=_e(),this.DS.subscribe("Settings:updated:selectorAreaClass",function(t){var s=t.settings;e.HTMLNode.classList.remove(s["selectorAreaClass:pre"]),e.HTMLNode.classList.add(s.selectorAreaClass)}),this.HTMLNode.classList.add(this.DS.stores.SettingsStore.s.selectorAreaClass),this.DS.subscribe("Area:modified",this.updatePos),this.DS.subscribe("Area:modified",this.updatePos),this.DS.subscribe("Interaction:init",this.start),this.DS.subscribe("Interaction:start",this.startAutoScroll),this.DS.subscribe("Interaction:end",function(){e.updatePos(),e.stopAutoScroll()})}return p(n,[{key:"isClicked",value:function(e){var i=this.DS.stores.PointerStore,t=e?i.getPointerPosition(e):i.initialVal;return K({left:t.x,top:t.y,right:t.x,bottom:t.y},this.rect)}},{key:"rect",get:function(){return this._rect?this._rect:this._rect=this.HTMLNode.getBoundingClientRect()}}]),n}(),Ye=function(){function n(r){var e=this,i=r.DS;h(this,n),o(this,"_currentValues",new Set),o(this,"_keyMapping",{control:"ctrlKey",shift:"shiftKey",meta:"metaKey"}),o(this,"init",function(){document.addEventListener("keydown",e.keydown),document.addEventListener("keyup",e.keyup),window.addEventListener("blur",e.reset)}),o(this,"keydown",function(t){var s=t.key.toLowerCase();e.DS.publish("KeyStore:down:pre",{event:t,key:s}),e._currentValues.add(s),e.DS.publish("KeyStore:down",{event:t,key:s})}),o(this,"keyup",function(t){var s=t.key.toLowerCase();e.DS.publish("KeyStore:up:pre",{event:t,key:s}),e._currentValues.delete(s),e.DS.publish("KeyStore:up",{event:t,key:s})}),o(this,"stop",function(){document.removeEventListener("keydown",e.keydown),document.removeEventListener("keyup",e.reset),window.removeEventListener("blur",e.reset),e.reset()}),o(this,"reset",function(){return e._currentValues.clear()}),this.DS=i,this.DS.subscribe("Interaction:init",this.init)}return p(n,[{key:"isMultiSelectKeyPressed",value:function(e){var i=this;if(this.DS.stores.SettingsStore.s.multiSelectMode)return!0;var t=this.DS.stores.SettingsStore.s.multiSelectKeys.map(function(s){return s.toLocaleLowerCase()});return!!(this.currentValues.some(function(s){return t.includes(s.toLocaleLowerCase())})||e&&t.some(function(s){return e[i._keyMapping[s]]}))}},{key:"currentValues",get:function(){return Array.from(this._currentValues.values())}}]),n}(),qe=function(){function n(r){var e=this,i=r.DS;h(this,n),o(this,"_isMouseInteraction",!1),o(this,"_initialValArea",void 0),o(this,"_currentValArea",void 0),o(this,"_lastValArea",void 0),o(this,"_initialVal",void 0),o(this,"_currentVal",void 0),o(this,"_lastVal",void 0),o(this,"_lastTouch",void 0),o(this,"init",function(){e.Settings.usePointerEvents?document.addEventListener("pointermove",e.update,{passive:!1}):document.addEventListener("mousemove",e.update),document.addEventListener("touchmove",e.update,{passive:!1})}),o(this,"getPointerPosition",function(t){return Ae({event:e._normalizedEvent(t)})}),o(this,"update",function(t){!t||(e.DS.publish("PointerStore:updated:pre",{event:t}),e.currentVal=e.getPointerPosition(t),e._isMouseInteraction&&e.DS.publish("PointerStore:updated",{event:t}))}),o(this,"stop",function(){e.Settings.usePointerEvents?document.removeEventListener("pointermove",e.update,{passive:!1}):document.removeEventListener("mousemove",e.update),document.removeEventListener("touchmove",e.update,{passive:!1}),setTimeout(function(){return e._isMouseInteraction=!1},100)}),o(this,"reset",function(t){!t||(e.currentVal=e.lastVal=e.getPointerPosition(t),e.stop(),e.init())}),this.DS=i,this.Settings=i.stores.SettingsStore.s,this.DS.subscribe("Interaction:init",this.init),this.DS.subscribe("Interaction:start",function(t){var s=t.event;return e.start(s)}),this.DS.subscribe("Interaction:end",function(t){var s=t.event;return e.reset(s)})}return p(n,[{key:"start",value:function(e){!e||(this._isMouseInteraction=!0,this.currentVal=this.initialVal=this.getPointerPosition(e))}},{key:"_normalizedEvent",value:function(e){return"touches"in e&&e.type!=="touchend"&&(this._lastTouch=e),"touches"in e?this._lastTouch.touches[0]:e}},{key:"initialValArea",get:function(){return this._initialValArea?this._initialValArea:{x:0,y:0}}},{key:"currentValArea",get:function(){return this._currentValArea?this._currentValArea:{x:0,y:0}}},{key:"lastValArea",get:function(){return this._lastValArea?this._lastValArea:{x:0,y:0}}},{key:"initialVal",get:function(){return this._initialVal?this._initialVal:{x:0,y:0}},set:function(e){this._initialVal=e,this._initialValArea=e&&P(e,"-",P(M(this.DS.Area.rect),"+",M(this.DS.Area.computedBorder)))}},{key:"currentVal",get:function(){return this._currentVal?this._currentVal:{x:0,y:0}},set:function(e){this._currentVal=e,this._currentValArea=e&&P(e,"-",P(M(this.DS.Area.rect),"+",M(this.DS.Area.computedBorder)))}},{key:"lastVal",get:function(){return this._lastVal?this._lastVal:{x:0,y:0}},set:function(e){this._lastVal=e,this._lastValArea=e&&P(e,"-",P(M(this.DS.Area.rect),"+",M(this.DS.Area.computedBorder)))}}]),n}(),Je=function(){function n(r){var e=this,i=r.DS;h(this,n),o(this,"_initialVal",void 0),o(this,"_currentVal",void 0),o(this,"_canScroll",void 0),o(this,"init",function(){return e.DS.stores.SettingsStore.s.area.addEventListener("scroll",e.update)}),o(this,"start",function(){e._currentVal=e._initialVal=z(e.DS.stores.SettingsStore.s.area),e.DS.stores.SettingsStore.s.area.addEventListener("scroll",e.update)}),o(this,"update",function(){return e._currentVal=z(e.DS.stores.SettingsStore.s.area)}),o(this,"stop",function(){e.DS.stores.SettingsStore.s.area.removeEventListener("scroll",e.update),e._initialVal={x:0,y:0},e._canScroll=null}),o(this,"reset",function(){e.stop(),e.start()}),this.DS=i,this.DS.subscribe("Interaction:init",this.init),this.DS.subscribe("Interaction:start",function(){return e.start()}),this.DS.subscribe("Interaction:end",function(){return e.reset()})}return p(n,[{key:"canScroll",get:function(){return typeof this._canScroll=="boolean"?this._canScroll:this._canScroll=De(this.DS.stores.SettingsStore.s.area)}},{key:"scrollAmount",get:function(){var e=P(this.currentVal,"-",this.initialVal),i=be(this.DS.stores.SettingsStore.s.zoom),t=P(P(e,"*",i),"-",e);return{x:e.x+t.x,y:e.y+t.y}}},{key:"initialVal",get:function(){return this._initialVal?this._initialVal:{x:0,y:0}}},{key:"currentVal",get:function(){return this._currentVal||(this._currentVal=z(this.DS.stores.SettingsStore.s.area)),this._currentVal}}]),n}(),Qe=function n(r){var e=this,i=r.DS,t=r.settings;h(this,n),o(this,"_settings",{}),o(this,"s",{}),o(this,"update",function(s){var a=s.settings,l=s.init;return e.DS.publish("Settings:updated:pre",u({settings:a},l?{init:l}:{}))}),o(this,"_update",function(s){for(var a=s.settings,l=s.init,c=Ve(a,l),d=function(){var I,x=j(b[S],2),D=x[0],T=x[1];D in e._settings||Object.defineProperty(e.s,D,{get:function(){return e._settings[D]},set:function(k){return e.update({settings:o({},D,k)})}}),e._settings["".concat(D,":pre")]=e._settings[D],e._settings[D]=T;var R={settings:(I={},o(I,D,e._settings[D]),o(I,"".concat(D,":pre"),e._settings["".concat(D,":pre")]),I)};e.DS.publish("Settings:updated",R),e.DS.publish("Settings:updated:".concat(D),R)},S=0,b=Object.entries(c);S<b.length;S++)d()}),this.DS=i,this.DS.subscribe("Settings:updated:pre",this._update),this.update({settings:t,init:!0})},Fe=function(){function n(r){var e=this;h(this,n),o(this,"continue",!1),o(this,"start",function(){e.stopped=!1,e.Interaction.init()}),o(this,"break",function(){return e.continue=!0}),o(this,"setSettings",function(i){return e.stores.SettingsStore.update({settings:i})}),o(this,"getSelection",function(){return e.SelectedSet.elements}),o(this,"getSelectables",function(){return e.SelectableSet.elements}),o(this,"getInitialCursorPosition",function(){return e.stores.PointerStore.initialVal}),o(this,"getCurrentCursorPosition",function(){return e.stores.PointerStore.currentVal}),o(this,"getPreviousCursorPosition",function(){return e.stores.PointerStore.lastVal}),o(this,"getInitialCursorPositionArea",function(){return e.stores.PointerStore.initialValArea}),o(this,"getCurrentCursorPositionArea",function(){return e.stores.PointerStore.currentValArea}),o(this,"getPreviousCursorPositionArea",function(){return e.stores.PointerStore.lastValArea}),o(this,"isMultiSelect",function(i){return e.stores.KeyStore.isMultiSelectKeyPressed(i)}),o(this,"isDragging",function(){return e.Interaction.isDragging}),o(this,"getZoneByCoordinates",function(i){var t;return(t=e.DropZones.getTarget(i))===null||t===void 0?void 0:t.toObject()}),o(this,"getItemsDroppedByZoneId",function(i){return e.DropZones.getItemsDroppedById(i)}),o(this,"getItemsInsideByZoneId",function(i,t){return e.DropZones.getItemsInsideById(i,t)}),this.PubSub=new Be({DS:this}),this.subscribe=this.PubSub.subscribe,this.unsubscribe=this.PubSub.unsubscribe,this.publish=this.PubSub.publish,this.stores={},this.stores.SettingsStore=new Qe({DS:this,settings:r}),this.stores.PointerStore=new qe({DS:this}),this.stores.ScrollStore=new Je({DS:this}),this.stores.KeyStore=new Ye({DS:this}),this.Area=new Re({DS:this}),this.Selector=new Ue({DS:this}),this.SelectorArea=new Xe({DS:this}),this.SelectableSet=new $e({DS:this}),this.SelectedSet=new We({DS:this}),this.Selection=new Ge({DS:this}),this.Drag=new Ze({DS:this}),this.DropZones=new ze({DS:this}),this.Interaction=new je({DS:this}),Oe({subscribe:this.subscribe,publish:this.publish,SelectedSet:this.SelectedSet,Interaction:this.Interaction,DropZones:this.DropZones}),this.subscribe("Interaction:end",function(){return e.continue=!1}),this.start()}return p(n,[{key:"stop",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;t&&this.publish("callback",{items:this.getSelection()}),this.Interaction.stop(),this.Area.stop(),this.Drag.stop(),this.Selector.stop(),this.SelectorArea.stop(e),this.stores.KeyStore.stop(),this.stores.PointerStore.stop(),this.stores.ScrollStore.stop(),e&&this.SelectableSet.clear(),i&&this.SelectedSet.clear(),this.stopped=!0}},{key:"addSelection",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return this.SelectedSet.addAll(w(e)),t||this.addSelectables(e),i&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"removeSelection",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return this.SelectedSet.deleteAll(w(e)),t&&this.removeSelectables(e),i&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"toggleSelection",value:function(e){var i=this,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return w(e).forEach(function(a){return i.SelectedSet.has(a)?i.removeSelection(e,t,s):i.addSelection(e,t,s)}),t&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"setSelection",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return this.clearSelection(),this.addSelection(e,i,t),this.getSelection()}},{key:"clearSelection",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.SelectedSet.clear(),e&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"addSelectables",value:function(e,i,t){var s=w(e);return this.SelectableSet.addAll(s),i&&this.SelectedSet.addAll(s),t&&this.PubSub.publish("callback",{items:this.getSelection()}),e}},{key:"setSelectables",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return console.warn('[DragSelect] DEPRECATION ".setSelectables" is deprecated and will be removed soon. Please use "ds.setSettings({ selectables: << new dom elements >> })" instead (see docs)'),this.removeSelectables(e,i),this.addSelectables(e,t)}},{key:"removeSelectables",value:function(e,i,t){return this.SelectableSet.deleteAll(w(e)),i&&this.removeSelection(e),t&&this.PubSub.publish("callback",{items:this.getSelection()}),e}}]),n}();return Fe})})(ae);const st=ae.exports,le=g=>{const m=g.createReader();return new Promise(h=>{const y=[],p=()=>{};function o(){m.readEntries(v=>{v.length?(y.push(Promise.all(v.map(u=>u.isDirectory?le(u):Promise.resolve(u)))),o()):h(Promise.all(y))},p)}o()})},ce=(g,m)=>({fileObject:g,fullPath:m?m.fullPath:"",lastModified:g.lastModified,lastModifiedDate:g.lastModifiedDate,name:g.name,size:g.size,type:g.type,webkitRelativePath:g.webkitRelativePath}),ie=g=>new Promise(m=>{g.file(h=>{m(ce(h,g))})}),oe=(g,m)=>Promise.all(g).then(h=>(h.forEach(y=>{m.push(y)}),m)),tt=g=>{const m=[],h=[],y=[];if([].slice.call(g.items).forEach(p=>{let o;typeof p.webkitGetAsEntry=="function"?o="webkitGetAsEntry":o="getAsEntry";const v=p[o]();v?v.isDirectory?h.push(le(v)):y.push(ie(v)):m.push(p)}),h.length){const p=o=>o.reduce((v,u)=>v.concat(Array.isArray(u)?p(u):u),[]);return Promise.all(h).then(o=>(p(o).forEach(u=>{y.push(ie(u))}),oe(y,m)))}else if(y.length)return oe(y,m);return Promise.resolve(m)},rt=g=>{const m=g.dataTransfer;if(m&&m.items)return tt(m).then(v=>Promise.resolve(v));const h=[],y=m&&m.files,p=g.target&&g.target.files,o=y||p||[];for(let v=0;v<o.length;v++)h.push(ce(o[v]));return Promise.resolve(h)};async function it(g){let m=await rt(g),h={};for(let y of m){let p=y.fullPath.split("/").filter(o=>o!="");p.reduce((o,v,u)=>(u!=p.length-1?o[v]==null&&(o[v]={}):o[v]=y.fileObject,o[v]),h)}return h}export{st as D,it as p};
